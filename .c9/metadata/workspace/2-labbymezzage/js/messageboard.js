{"changed":true,"filter":false,"title":"messageboard.js","tooltip":"/2-labbymezzage/js/messageboard.js","value":"\"use strict\";\n\nfunction MessageBoard(elementID) {\n    var messages = [];\n    \n    /* root element */\n    this.root = document.getElementById(elementID);\n    \n    this.getMessages = function() {\n        return messages;\n    };\n    \n    this.getMessage = function(messageID) {\n        return messages[messageID];\n    };\n    \n    this.createApp();\n}\n\nMessageBoard.prototype.createApp = function() {\n    var appBody, div, header, appVersion, messageCount, textarea, submitButton;\n    var that = this;\n    \n    /* Section */\n    appBody = document.createElement(\"section\");\n    appBody.className = \"LabbyMezzage\";\n    this.root.appendChild(appBody);\n    \n    /* Header */\n    header = document.createElement(\"header\");\n    appVersion = document.createElement(\"p\");\n    appVersion.innerHTML = \"v0.1b\";\n    header.appendChild(appVersion);\n    appBody.appendChild(header);\n    \n    /* Holder div */\n    div = document.createElement(\"div\");\n    appBody.appendChild(div);\n    \n    /* Message Counter */\n    messageCount = document.createElement(\"span\");\n    messageCount.innerHTML = \"Antal Meddelanden: \" + this.getMessages().length;\n    div.appendChild(messageCount);\n    \n    /* Textarea */\n    textarea = document.createElement(\"textarea\");\n    textarea.onkeypress = function(e) {\n        if(e.keyCode == 13) {\n            if(!e.shiftKey) {\n                e.preventDefault();\n                that.sendMessage();\n                return false;\n            }\n        }\n    };\n    div.appendChild(textarea);\n    \n    /* Send-button */\n    submitButton = document.createElement(\"button\");\n    submitButton.type = \"submit\";\n    submitButton.innerHTML = \"Skriv\";\n    submitButton.onclick = function(e) {\n        e.preventDefault();\n        that.sendMessage();\n        return false;\n    };\n    div.appendChild(submitButton);\n};\n\nMessageBoard.prototype.updateMessageCount = function() {\n    this.root.querySelector(\"span\").innerHTML = \"Antal Meddelanden: \" + this.getMessages().length;\n};\n\nMessageBoard.prototype.sendMessage = function() {\n    var textarea = this.root.querySelector(\"textarea\");\n    // Remove all HTML tags\n    textarea.value = textarea.value.replace( /<[^>]+>/g, '' );\n    if(textarea.value.trim() !== \"\") {\n        this.getMessages().push(new Message(textarea.value.trim(), new Date()));\n    }\n    textarea.value = \"\";\n    this.renderMessage(this.getMessages().length - 1);\n};\n\nMessageBoard.prototype.removeMessage = function(messageID) {\n    this.getMessages().splice(messageID, 1);\n    this.renderMessages();\n    this.updateMessageCount();\n};\n\nMessageBoard.prototype.renderMessage = function(messageID) {\n    var that = this;\n    var messageContainer = document.createElement(\"div\");\n    var messageText = document.createElement(\"p\");\n    var messageDate = document.createElement(\"p\");\n    var imgRemove = document.createElement(\"img\");\n    var imgTimeStamp = document.createElement(\"img\");\n    var insertDestination = this.root.querySelector(\"div\");\n    imgRemove.alt = \"En lila icon med en klocka på\";\n    imgRemove.title = \"Ta bort meddelandet\";\n    imgRemove.src = \"images/crossIcon.png\";\n    imgRemove.onclick = function(e) {\n        if(window.confirm(\"Vill du verkligen radera meddelandet?\")) {\n            e.preventDefault();\n            that.removeMessage(messageID);\n            return false;\n        }\n    };\n    imgTimeStamp.alt = \"En röd icon med ett kryss på\";\n    imgTimeStamp.title = \"Kolla vilken tid inlägget skrevs\";\n    imgTimeStamp.src = \"images/clockIcon.png\";\n    imgTimeStamp.onclick = function(e) {\n        e.preventDefault();\n        alert(that.getMessage(messageID).getTimeStamp());\n        return false;\n    };\n    messageText.innerHTML = this.getMessage(messageID).getHTMLText();\n    messageDate.innerHTML = this.getMessage(messageID).getDateText();\n    messageContainer.appendChild(imgRemove);\n    messageContainer.appendChild(imgTimeStamp);\n    messageContainer.appendChild(messageText);\n    messageContainer.appendChild(messageDate);\n    /* Insert the new message at the top of the holder div, at the bottom of the message list */\n    insertDestination.insertBefore(messageContainer, insertDestination.childNodes[messageID]);\n    this.updateMessageCount();\n};\n\nMessageBoard.prototype.renderMessages = function() {\n    var divs, i;\n    \n    // Remove all messages\n    divs = this.root.querySelectorAll(\"div\");\n    /* First div element is the holder div, don't remove it */\n    for(i = 1; i < divs.length; i+=1) {\n        /* To remove an object, you need to target the parent */\n        divs[i].parentNode.removeChild(divs[i]);\n    }\n    \n    // Render all messages\n    for(i = 0; i < this.getMessages().length; i+=1) {\n        this.renderMessage(i);\n    }\n};","undoManager":{"mark":97,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":48,"column":15},"end":{"row":48,"column":16},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":15},"end":{"row":48,"column":16},"action":"insert","lines":["!"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":16},"end":{"row":48,"column":17},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":17},"end":{"row":48,"column":18},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":18},"end":{"row":48,"column":19},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":19},"end":{"row":48,"column":20},"action":"insert","lines":["h"]},{"start":{"row":48,"column":20},"end":{"row":48,"column":21},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":21},"end":{"row":48,"column":22},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":22},"end":{"row":48,"column":23},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":23},"end":{"row":48,"column":24},"action":"insert","lines":["K"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":24},"end":{"row":48,"column":25},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":25},"end":{"row":48,"column":26},"action":"insert","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":27},"end":{"row":48,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":28},"end":{"row":48,"column":29},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":49,"column":0},"end":{"row":49,"column":4},"action":"insert","lines":["    "]},{"start":{"row":50,"column":0},"end":{"row":50,"column":4},"action":"insert","lines":["    "]},{"start":{"row":51,"column":0},"end":{"row":51,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":29},"end":{"row":52,"column":0},"action":"insert","lines":["",""]},{"start":{"row":52,"column":0},"end":{"row":52,"column":16},"action":"insert","lines":["                "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":12},"end":{"row":52,"column":16},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":12},"end":{"row":52,"column":13},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":109,"column":40},"end":{"row":110,"column":0},"action":"insert","lines":["",""]},{"start":{"row":110,"column":0},"end":{"row":110,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":8},"end":{"row":110,"column":9},"action":"insert","lines":["i"]},{"start":{"row":110,"column":9},"end":{"row":110,"column":10},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":10},"end":{"row":110,"column":12},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":11},"end":{"row":110,"column":12},"action":"insert","lines":["w"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":12},"end":{"row":110,"column":13},"action":"insert","lines":["i"]},{"start":{"row":110,"column":13},"end":{"row":110,"column":14},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":14},"end":{"row":110,"column":15},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":14},"end":{"row":110,"column":15},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":13},"end":{"row":110,"column":14},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":12},"end":{"row":110,"column":13},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":11},"end":{"row":110,"column":12},"action":"remove","lines":["w"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":10},"end":{"row":110,"column":12},"action":"remove","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":9},"end":{"row":110,"column":10},"action":"remove","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":8},"end":{"row":110,"column":9},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":4},"end":{"row":110,"column":8},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":0},"end":{"row":110,"column":4},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":109,"column":40},"end":{"row":110,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":101,"column":37},"end":{"row":102,"column":0},"action":"insert","lines":["",""]},{"start":{"row":102,"column":0},"end":{"row":102,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":8},"end":{"row":102,"column":9},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":9},"end":{"row":102,"column":10},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":10},"end":{"row":102,"column":12},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":11},"end":{"row":102,"column":12},"action":"insert","lines":["w"]},{"start":{"row":102,"column":12},"end":{"row":102,"column":13},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":13},"end":{"row":102,"column":14},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":14},"end":{"row":102,"column":15},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":15},"end":{"row":102,"column":16},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":16},"end":{"row":102,"column":17},"action":"insert","lines":["w"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":17},"end":{"row":102,"column":18},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":18},"end":{"row":102,"column":19},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":19},"end":{"row":102,"column":20},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":20},"end":{"row":102,"column":21},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":21},"end":{"row":102,"column":22},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":22},"end":{"row":102,"column":23},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":23},"end":{"row":102,"column":24},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":24},"end":{"row":102,"column":25},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":25},"end":{"row":102,"column":27},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":26},"end":{"row":102,"column":28},"action":"insert","lines":["\"\""]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"insert","lines":["V"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":28},"end":{"row":102,"column":29},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":29},"end":{"row":102,"column":30},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":30},"end":{"row":102,"column":31},"action":"insert","lines":["l"]},{"start":{"row":102,"column":31},"end":{"row":102,"column":32},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":32},"end":{"row":102,"column":33},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":33},"end":{"row":102,"column":34},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":34},"end":{"row":102,"column":35},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":35},"end":{"row":102,"column":36},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":36},"end":{"row":102,"column":37},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":37},"end":{"row":102,"column":38},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":38},"end":{"row":102,"column":39},"action":"insert","lines":["k"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":39},"end":{"row":102,"column":40},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":40},"end":{"row":102,"column":41},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":41},"end":{"row":102,"column":42},"action":"insert","lines":["g"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":42},"end":{"row":102,"column":43},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":43},"end":{"row":102,"column":44},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":44},"end":{"row":102,"column":45},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":45},"end":{"row":102,"column":46},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":46},"end":{"row":102,"column":47},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":46},"end":{"row":102,"column":47},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":46},"end":{"row":102,"column":47},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":47},"end":{"row":102,"column":48},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":48},"end":{"row":102,"column":49},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":49},"end":{"row":102,"column":50},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":50},"end":{"row":102,"column":51},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":51},"end":{"row":102,"column":52},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":52},"end":{"row":102,"column":53},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":53},"end":{"row":102,"column":54},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":54},"end":{"row":102,"column":55},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":54},"end":{"row":102,"column":55},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":54},"end":{"row":102,"column":55},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":55},"end":{"row":102,"column":56},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":56},"end":{"row":102,"column":57},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":57},"end":{"row":102,"column":58},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":58},"end":{"row":102,"column":59},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":59},"end":{"row":102,"column":60},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":60},"end":{"row":102,"column":61},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":61},"end":{"row":102,"column":62},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":62},"end":{"row":102,"column":63},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":63},"end":{"row":102,"column":64},"action":"insert","lines":["?"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":67},"end":{"row":102,"column":68},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":67},"end":{"row":102,"column":68},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":103,"column":0},"end":{"row":103,"column":4},"action":"insert","lines":["    "]},{"start":{"row":104,"column":0},"end":{"row":104,"column":4},"action":"insert","lines":["    "]},{"start":{"row":105,"column":0},"end":{"row":105,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":105,"column":25},"end":{"row":106,"column":0},"action":"insert","lines":["",""]},{"start":{"row":106,"column":0},"end":{"row":106,"column":12},"action":"insert","lines":["            "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":8},"end":{"row":106,"column":12},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":8},"end":{"row":106,"column":9},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":144,"column":0},"end":{"row":146,"column":2},"action":"remove","lines":["window.onload = function() {","    var what = new MessageBoard(\"msg1\");","};"]}]}],[{"group":"doc","deltas":[{"start":{"row":143,"column":0},"end":{"row":144,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":142,"column":2},"end":{"row":143,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":1716,"scrollleft":0,"selection":{"start":{"row":142,"column":2},"end":{"row":142,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1417030129132}